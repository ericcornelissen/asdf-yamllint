#!/usr/bin/env bash

set -eo pipefail

current_script_path=${BASH_SOURCE[0]}
plugin_dir=$(dirname "$(dirname "${current_script_path}")")
# shellcheck source=./lib/common.sh
source "${plugin_dir}/lib/common.sh"

check_env_var "ASDF_INSTALL_PATH" "${ASDF_INSTALL_PATH}"
check_env_var "ASDF_INSTALL_VERSION" "${ASDF_INSTALL_VERSION}"

check_prerequisite 'curl'
check_prerequisite 'jq'

if [ -z "${ASDF_DOWNLOAD_PATH}" ]; then
	download_version "${ASDF_INSTALL_VERSION}" "${ASDF_INSTALL_PATH}"
fi

install_version "${ASDF_INSTALL_VERSION}" "${ASDF_INSTALL_PATH}" "${ASDF_DOWNLOAD_PATH}"
